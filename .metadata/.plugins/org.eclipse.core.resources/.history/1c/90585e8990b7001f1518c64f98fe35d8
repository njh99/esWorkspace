<%@ page contentType="text/html; charset=UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<title>Register Form</title>
<link href="style.css" rel="stylesheet" type="text/css" />
 <script language="javascript" src="loginscript.js"></script>
 <script>function onLoad() {
		//패턴 검색 내용
		const idPattern = /^[\w]{3,}$/;//[\w]는 영문자, 숫자,_만 입력가능
		const pwdPattern = /^[\w]{6,10}$/;//영문자 숫자 _까지 6~10
		const namePattern = /^[가-힣]{2,4}|[A-Z]{1}[a-zA-Z\x20]{1,19}$/;//한글 2글자~4글자,영문자 2글지~20글자 첫글자는 대문자 공백가능
		const nicknamePattern = /^[\w가-힣]{4,}$/;//공백없이 한글,영문,숫자,_만 입력 가능(4글자 이상)
		const emialPattern = /^[a-z0-9_+.-]+@([a-z0-9-]+.)+[a-z0-9]{2,4}$/i;//공백없이 한글,영문,숫자,_만 입력 가능(4글자 이상)
		const telPattern = /^\d{2,3}-\d{3,4}-\d{4}$/;
		const datePattern = /^\d{4}-\d{2}-\d{2}$/;
		//객체 찾기
		const inputid = document.querySelector("#id");
		const inputpw1 = document.querySelector("#input-pw1");
		const inputpw2 = document.querySelector("#input-pw2");
		const inputname = document.querySelector("#input-name");
		const nickinputname = document.querySelector("#input-nickname");
		const emialinputname = document.querySelector("#input-email");
		const inputtel = document.querySelector("#input-tel");
		const inputdate = document.querySelector('[type="date"]');

		//주소 객체
		const zipcode = document.querySelector("#zipcode");
		const addr1 = document.querySelector("#addr1");
		const addr2 = document.querySelector("#addr2");
		const btnsearch = document.querySelector("#btn-searchAddr");
		//폼 객체찾기
		const myform = document.querySelector(".myform");




		//이벤트 리스너 등록 및 처리
		inputid.addEventListener("blur", () => validate(inputid, idPattern, "영문자, 숫자, _만 입력 가능."));
		inputpw1.addEventListener("blur", () => validate(inputpw1, pwdPattern, "영문자 숫자 _까지 6~10 가능."));
		inputpw2.addEventListener("blur", () => {
			validate(inputpw2, pwdPattern, "영문자 숫자 _까지 6~10 가능.");
			if (inputpw1.value !== inputpw2.value) {
				inputpw2.nextSibling.textContent = "패스워드가 일치하지 않습니다"
				inputpw2.nextSibling.style.color = "red";
				inputpw1.value = "";
				inputpw2.value = "";
				inputpw1.focus();
				return;
			};
		});
		inputname.addEventListener("blur", () => validate(inputname, namePattern, "한글 2글자~4글자,영문자 2글지~20글자 첫글자는 대문자 공백가능."));
		nickinputname.addEventListener("blur", () => validate(nickinputname, nicknamePattern, "공백없이 한글,영문,숫자,_만 입력 가능(4글자 이상)"));
		emialinputname.addEventListener("blur", () => validate(emialinputname, emialPattern, "이메일 양식에 맞지 않음"));
		inputtel.addEventListener("blur", () => validate(inputtel, telPattern, "전화형식에 맞지 않음"));
		inputdate.addEventListener("blur", () => validate(inputdate, datePattern, "날짜 선택하세요"));
		btnsearch.addEventListener("click", () => {
			new daum.Postcode({
				oncomplete: function(data) {
					// 팝업에서 검색결과 항목을 클릭했을때 실행할 코드
					zipcode.value = data.zonecode;
					addr1.value = data.roadAddress;
				}
			}).open();
		});
		//폼 이벤트 등록 및 핸들러 처리
		myform.addEventListener("submit", (e) => {
			e.preventDefault();//서버에 전송하는 기본기능을 막는다.
			validate(inputid, idPattern, "영문자, 숫자, _만 입력 가능.");
			validate(inputpw1, pwdPattern, "영문자 숫자 _까지 6~10 가능.");
			validate(inputpw2, pwdPattern, "영문자 숫자 _까지 6~10 가능.")
			if (inputpw1.value !== inputpw2.value) {
				inputpw2.nextSibling.textContent = "패스워드가 일치하지 않습니다"
				inputpw2.nextSibling.style.color = "red";
				inputpw1.value = "";
				inputpw2.value = "";
				inputpw1.focus();
				return;
			}
			validate(inputname, namePattern, "한글 2글자~4글자,영문자 2글지~20글자 첫글자는 대문자 공백가능.");
			validate(nickinputname, nicknamePattern, "공백없이 한글,영문,숫자,_만 입력 가능(4글자 이상)");
			validate(emialinputname, emialPattern, "이메일 양식에 맞지 않음");
			validate(inputtel, telPattern, "전화형식에 맞지 않음");
			validate(inputmobile, mobilePattern, "전화형식에 맞지 않음");
			validate(inputdate, datePattern, "날짜 선택하세요");
			if (zipcode.value === "" || addr1.value === "") {
				zipcode.nextSibling.textContent = "주소선택해주세요";
				zipcode.focus();
				return;
			}
			alert("서버로 전송하겠습니다.");
			myform.submit();

		});


		//핸들러 처리기능
		function validate(userInput, pattern, message) {
			if (userInput.value.match(pattern)) {
				userInput.nextSibling.innerHTML = "성공";
				userInput.nextSibling.style.color = "blue";
			} else {
				userInput.nextSibling.innerHTML = message;
				userInput.nextSibling.style.color = "red";
				userInput.value = "";
				userInput.focus();
				return;
			}
		}
	}</script>
</head>
<body onload="onLoad()">
<main>
	<form method="post" action="regProc.jsp" name="regForm">
		<table border="1">
			<tr>
				<td colspan="2" align="center">회원 가입 입력</td>
			</tr>
			<tr>
				<td align="center">아이디 :</td>
				<td><input type="text" name="id" /> 
				<input type="button" value="중복확인" onClick="idCheck()" /></td>
			</tr>
			<tr>
				<td align="center">패스워드 :</td>
				<td><input type="password" name="pass" /><span></span></td>
			</tr>
			<tr>
				<td align="center">패스워드 확인:</td>
				<td><input type="password" name="repass" /><span></span></td>
			</tr>
			<tr>
				<td align="center">이름 :</td>
				<td><input type="text" name="name" /><span></span></td>
			</tr>
			<tr>
				<td align="center">전화번호 :</td>
				<td><select name="phone1">
						<option value="010">010</option>
				</select> - <input type="text" name="phone2" size="5" /> - <input
					type="text" name="phone3" size="5" /></td>
			</tr>
			<tr>
				<td align="center">이메일 :</td>
				<td><input type="text" name="email" /><span></span></td>
			</tr>
			<tr>
				<td align="center">생년월일</td>
				<td><input type="date" name="birthday" id="birthday"><span></span></td>
			</tr>
			<tr>
				<td align="center">우편번호 :</td>
				<td><input type="text" name="zipcode" /><span></span> 
				<input type="button" value="찾기" onClick="zipCheck()" /></td>
			</tr>
			<tr>
				<td align="center">주소 :</td>
				<td><input type="text" name="address1" size="50" /><span></span></td>
			</tr>
			<tr>
				<td align="center">상세주소 :</td>
				<td><input type="text" name="address2" size="30" /><span></span></td>
			</tr>
			<tr>
				<td colspan="2" align="center">
				<input type="button" value="회원가입" onclick="" />&nbsp;&nbsp;
				<input type="reset" value="다시입력" /></td>
			</tr>
		</table>
	</form>
	</main>
</body>
</html>