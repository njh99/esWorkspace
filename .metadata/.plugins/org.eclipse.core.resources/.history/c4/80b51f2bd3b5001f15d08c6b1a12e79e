<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ page import="java.sql.*, java.util.*"%>
<%@ page import="java.io.FileReader"%>
<%@ page import="java.io.IOException"%>
<%@ page import="co.kh.dev352.signup.model.SignupDAO"%>
<%@ page import="co.kh.dev352.signup.model.SignupVO"%>
<!-- 1. 사용자정보를 가져온다  -->
<%
String id = request.getParameter("id");
String pwd = request.getParameter("pwd");
String pwdTest = request.getParameter("pwdtest");
String email = request.getParameter("email");
String name = request.getParameter("name");
int birth = Integer.parseInt( request.getParameter("birth"));
String message = "";
boolean isSuccess = false;
boolean returnFlag = false;
if (id != null && pwd != null && email != null && name != null && pwdTest != null) {
	if (pwdTest != null && !pwd.equals(pwdTest)) {
		message = "비밀번호와 비밀번호 확인이 일치하지 않습니다.";
	} else {
		/*2.CURD  */
		SignupDAO sdao = new SignupDAO();
		SignupVO svo = new SignupVO(id, pwd, email, name, birth);
		boolean returnFlag = sdao.insertDB(svo);

	}
}
%>
<!-- 2. CURD -->
<!-- 3. 화면설계(자바코드(x) -> jsp service 진행) -->
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>로그인</title>
<link rel="stylesheet" href="../css/signup.css">
</head>
<body>
<%
	if(returnFlag== false){
		%>		
		<h1>회원가입이 되었습니다.</h1>
	}
<%

%>
</body>
				out.println("<html>");
				out.println("<head>");
				out.println("<meta charset='UTF-8'>");
				out.println("<title>Insert title here</title>");
				out.println("</head>"); 
				out.println("<body>");
				out.println("<h1 align= 'center'>회원가입이 완료되었습니다.</h1>");
				out.println("<table align='center' width='300' border='1'>");
				out.println("<tr>");
				out.println("<td align='center'>");
				out.println("이름 = " + name);
				out.println("</td>");
				out.println("</tr>");
				out.println("<tr>");
				out.println("<tr>");
				out.println("<td align=\"center\">");
				out.println("id = " + uid);
				out.println("</td>");
				out.println("</tr>");
				out.println("<tr>");
				out.println("<td align=\"center\">");
				out.println("비밀번호 = " + pwd);
				out.println("</td>");
				out.println("</tr>");
				out.println("<tr>");
				out.println("<td align=\"center\">");
				out.println("<a href='loginServlet.do'><input type=\"button\" value=\"로그인\"></a>");
				out.println("</td>");
				out.println("</tr>");
				out.println("</table>");
				out.println("</body>");
				out.println("</html>");

<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>회원가입</title>
<link rel="stylesheet" href="./signup.css">
</head>
<body>
	<%
	/* 메세지가 존재하면 실행한다.(true) */
	if (!message.isEmpty()) {
	%>
	<p style="<%=isSuccess ? "color: green;" : "color: red;"%>"><%=message%></p>
	<%
	if (isSuccess) {
	%>
	<!-- setTimeout 딱 한번만 3초후에 함수를 콜해준다. -->
	<script>
		setTimeout(function() {
			window.location.href = 'login.jsp';
		}, 3000);
	</script>
	<%
	}
	%>
	<%
	}
	%>
</body>
</html>